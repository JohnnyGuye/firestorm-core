<section class="container is-fluid">

    <h1>Tests</h1>
    
    <div>
        
        <firestorm-test-state-tag [state]="testState"></firestorm-test-state-tag>
    
        <button mat-button (click)="run()">
            Run
        </button>
        
        <button mat-button (click)="reset()" [disabled]="false">
            Reset
        </button>
    
    </div>
    
    <mat-tree #tree [dataSource]="testPlan.root.testers" [childrenAccessor]="childrenAccessor">
      
      <!-- LEAF NODES -->

      <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
        
        <div class="test-line">
       
          <div class="start">
            <mat-icon class="mat-icon notranslate mat-icon-rtl-mirror material-icons mat-ligature-font mat-icon-no-color"></mat-icon>
          </div>

          <div class="middle">
            {{node.name}}
          </div>

          <div class="end">
            <firestorm-test-state-tag [state]="node.state"></firestorm-test-state-tag>
          </div>

        </div>

      </mat-tree-node>

      <!-- EXPANDABLE NODES -->

      <mat-tree-node 
        *matTreeNodeDef="let node;when: hasChild" 
        matTreeNodePadding 
        matTreeNodeToggle
        [cdkTreeNodeTypeaheadLabel]="node.name">
    
        <div class="test-line">
       
          <div class="start">
            <mat-icon 
              matTreeNodeToggle 
              class="mat-icon notranslate mat-icon-rtl-mirror material-icons mat-ligature-font mat-icon-no-color">
              {{tree.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
            </mat-icon>
          </div>

          <div class="middle">
            {{node.name}}
          </div>

          <div class="end">
            <div class="tags">
              <span class="tag">{{node.successfulChildrenCount}}/{{node.directChildrenCount}}</span>
              <firestorm-test-state-tag [state]="node.state"></firestorm-test-state-tag>
            </div>
          </div>

        </div>
        
      </mat-tree-node>
      
    </mat-tree>

</section>